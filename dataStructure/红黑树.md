# 红黑树

## 定义

红黑树是一种二叉查找树，是基于平衡二叉树的不同实现方式，摒弃了平衡二叉树的节点的平衡因子，对每个节点赋予一个颜色（Red/Black）使二叉查找树在插入或删除节点时维持平衡状态。

红黑树满足如下条件：

- 红黑树的每个节点都有一个颜色；root节点总黑色的；空子节点总是黑色
- 任意一对父子节点不能同时为红色
- **任意一个节点向下遍历至任一叶子节点的路径中黑色节点的个数相同**

## RBTree的插入操作与调整规则

先依据查找树规则找到插入位置，然后依据规则进行调整。RBTree的插入调整操作是自底向上回溯的，直到达到边界条件停止调整，RBTree达到平衡状态。

### 边界操作

- `root=null`

  将root指向为插入节点，颜色设为黑色

- 回溯至插入节点为root

  将root节点设置为黑色

- 插入节点的父节点为黑色

  将插入节点设置为红色，RBTree达到平衡状态，停止调整；

### 修复操作（插入节点的父节点为红色）

- 插入节点的叔叔节点是红色

  将父节点和叔叔节点颜色与祖父节点颜色互换，再将祖父节点视为插入节点调整

  ![](https://i.loli.net/2021/04/16/U63euJR8rivpoXF.png)	![](https://i.loli.net/2021/04/16/xRNTSWk723Cu6an.png)	![](https://i.loli.net/2021/04/16/HjwlnBoIXCGxKbQ.png)

- 插入节点的叔叔节点不存在或者为黑色

  - 插入节点、父节点、祖父节点在同一斜线上

    父节点与祖父节点颜色互换，祖父节点右旋（或左旋），再将父节点视为插入节点调整

    ![](https://i.loli.net/2021/04/16/zavAVgHinsSrwTy.png)	![](https://i.loli.net/2021/04/16/yPe8CfvkKTzEgrc.png)

  - 不在同一斜线上

    - 父节点是左孩子

      父节点左旋，变为同一斜线情况，将原父节点视为插入节点进行调整

      ![](https://i.loli.net/2021/04/16/7JiLbU4CXHAzeoq.png)
      ![](https://i.loli.net/2021/04/16/PzlCKo45v8pnEq2.png)
      ![](https://i.loli.net/2021/04/16/R453cAguFjpVanJ.png)

      
    
    - 父节点是右孩子
    
      父节点右旋，变为同一斜线情况，将原父节点视为插入节点进行调整（同上）